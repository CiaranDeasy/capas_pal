append( [], L, L ).
append( [H|T], L1, [H|L2] ) :- append( T, L1, L2 ).

length( [], 0 ).
length( [_|T], N ) :- length( T, M ), N is M+1.

mergesort( [], [] ) :- !.
mergesort( [H], [H] ) :- !.
mergesort( [H1,H2], [H1,H2] ) :- H1 < H2, !.
mergesort( [H1,H2], [H2,H1] ) :- !.
mergesort( L, Lsorted ) :- halveList( L, L1, L2 ), mergesort( L1, L1sorted ), 
        mergesort( L2, L2sorted ), merge( L1sorted, L2sorted, Lsorted ).

merge( [], L, L ).
merge( L, [], L ).
merge( [H1|T1], [H2|T2], [H1|T3] ) :- H1 < H2, !, merge( T1, [H2|T2], T3 ).
merge( [H1|T1], [H2|T2], [H2|T3] ) :- merge( [H1|T1], T2, T3 ).

halveList( L, L1, L2 ) :- length( L, N ), M is N/2, split( L, L1, L2, M ).

split( L, [], L, 0 ).
split( [H|T], [H|L1], L2, N ) :- M is N-1, split( T, L1, L2, M ).

%:- mergesort( [35,34,33,32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0], X ).
%:- mergesort( [38,23,37,4,19,50,1,34,15,52,18,57,59,53,56,48,54,22,29,17,12,32,31,10,21,25,47,30,45,20,40,9,16,26,3,49,11,8,6,35,33,43,13,14,39,46,5,44,2,7,42,27,28,36,60,41,58,24,55,51 ], X ).
%:- mergesort( [30, 151, 23, 199, 42, 59, 115, 168, 127, 35, 93, 188, 138, 13, 68, 99, 198, 152, 65, 131, 141, 177, 169, 154, 164, 180, 62, 37, 83, 26, 195, 34, 10, 193, 45, 29, 12, 53, 43, 72, 25, 161, 22, 122, 52, 66, 31, 140, 27, 158, 150, 110, 9, 120, 1, 114, 21, 132, 123, 33, 67, 89, 103, 55, 81, 54, 121, 6, 149, 125, 108, 11, 36, 130, 178, 104, 98, 172, 124, 139, 144, 18, 182, 51, 76, 69, 20, 137, 109, 87, 96, 28, 77, 128, 80, 38, 174, 170, 73, 142, 64, 75, 7, 61, 171, 116, 94, 185, 15, 157, 173, 86, 187, 189, 16, 50, 84, 2, 32, 85, 197, 112, 186, 196, 17, 105, 194, 129, 48, 175, 118, 44, 119, 111, 200, 91, 145, 126, 181, 146, 70, 184, 160, 153, 107, 74, 8, 166, 117, 14, 40, 165, 39, 63, 101, 41, 156, 147, 3, 56, 190, 78, 167, 97, 155, 24, 71, 143, 179, 57, 88, 148, 159, 183, 92, 47, 90, 191, 176, 102, 60, 4, 58, 135, 5, 113, 82, 49, 95, 106, 136, 134, 79, 19, 100, 192, 133, 162, 163, 46], X ).
:- mergesort( [30, 151, 23, 199, 42, 59, 115, 168, 127, 35, 93, 188, 138, 13, 68, 99, 198, 152, 65, 131, 141, 177, 169, 154, 164, 180, 62, 37, 83, 26, 195, 34, 10, 193, 45, 29, 12, 53, 43, 72, 25, 161, 22, 122, 52, 66, 31, 140, 27, 158, 150, 110, 9, 120, 1, 114, 21, 132, 123, 33, 67, 89, 103, 55, 81, 54, 121, 6, 149, 125, 108, 11, 36, 130, 178, 104, 98, 172, 124, 139, 144, 18, 182, 51, 76, 69, 20, 137, 109, 87, 96, 28, 77, 128, 80, 38, 174, 170, 73, 142, 64, 75, 7, 61, 171, 116, 94, 185, 15, 157, 173, 86, 187, 189, 16, 50, 84, 2, 32, 85, 197, 112, 186, 196, 17, 105, 194, 129, 48, 175, 118, 44, 119, 111, 200, 91, 145, 126, 181, 146, 70, 184, 160, 153, 107, 74, 8, 166, 117, 14, 40, 165, 39, 63, 101, 41, 156, 147, 3, 56, 190, 78, 167, 97, 155, 24, 71, 143, 179, 57, 88, 148, 159, 183, 92, 47, 90, 79, 19, 100, 192, 133, 162, 163, 46], X ).